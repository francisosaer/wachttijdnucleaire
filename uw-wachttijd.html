<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Uw wachttijd</title>

<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    padding: 30px;
    background: #f7f9fb;
  }

  h1 {
    margin-bottom: 5px;
  }

  #onderzoekNaam {
    font-size: 1.2em;
    font-weight: 600;
    margin-bottom: 15px;
    color: #333;
  }

  #timer {
    font-size: 3em;
    font-weight: bold;
    margin: 15px 0;
  }

  .timer-rood {
    color: #c62828;
  }

  #exactTijd {
    font-size: 1.3em;
    color: #444;
    margin-bottom: 15px;
  }

  #instructie {
    font-size: 1.2em;
    margin-top: 15px;
    color: #333;
  }

  #instructieAfbeelding {
    margin-top: 15px;
    max-width: 80px;
    display: none;
  }

  .boodschap-groen {
    color: #2e7d32;
    font-weight: 600;
    font-size: 1.25em;
    margin-top: 25px;
    opacity: 0;
    transition: opacity 0.8s ease-in;
  }

  .fade-in {
    opacity: 1;
  }
</style>
</head>

<body>

<h1 id="titel"></h1>
<div id="onderzoekNaam"></div>

<div id="exactTijd"></div>
<div id="timer">--</div>
<div id="instructie"></div>
<img id="instructieAfbeelding">
<div id="boodschap" class="boodschap-groen"></div>

<script>
/* ===== URL PARAMETERS ===== */
const params = new URLSearchParams(window.location.search);
const endTs = Number(params.get("end"));
const onderzoek = params.get("onderzoek") || "botscan";
const lang = params.get("lang") || "nl";

/* ===== VERTALINGEN ===== */
const vertalingen = {
  nl: {
    titel: "Uw wachttijd",
    onderzoeken: {
      botscan: "Botscan",
      schildklier: "Schildklierscan",
      mibi: "MIBI-scan",
      dmsa: "DMSA-scan",
      maag: "Maagontlediging",
      dat: "DAT-scan"
    },
    instructies: {
      botscan: "Wij vragen u om regelmatig water te drinken.",
      schildklier: "U mag plaatsnemen in de wachtzaal.",
      mibi: "Gelieve een vet ontbijt te gebruiken, bijvoorbeeld brood met kaas of salami.",
      dmsa: "Voor dit onderzoek hoeft u niet nuchter te zijn.",
      maag: "U mag plaatsnemen in de wachtzaal. Elke 30 minuten wordt er een opname gemaakt van ongeveer 1 minuut, in totaal vijf opnames.",
      dat: "Voor dit onderzoek hoeft u niet nuchter te zijn."
    },
    naarWachtzaal: "U mag zich begeven naar wachtzaal DOW3."
  },
  fr: {
    titel: "Votre temps d’attente",
    onderzoeken: {
      botscan: "Scintigraphie osseuse",
      schildklier: "Scintigraphie thyroïdienne",
      mibi: "Scintigraphie myocardique (MIBI)",
      dmsa: "Scintigraphie DMSA",
      maag: "Vidange gastrique",
      dat: "Scintigraphie DAT"
    },
    instructies: {
      botscan: "Nous vous demandons de boire régulièrement de l’eau.",
      schildklier: "Vous pouvez prendre place dans la salle d’attente.",
      mibi: "Veuillez prendre un petit-déjeuner gras, par exemple du pain avec du fromage ou du salami.",
      dmsa: "Vous ne devez pas être à jeun pour cet examen.",
      maag: "Vous pouvez prendre place dans la salle d’attente. Une acquisition d’environ une minute sera réalisée toutes les 30 minutes, pour un total de cinq acquisitions.",
      dat: "Vous ne devez pas être à jeun pour cet examen."
    },
    naarWachtzaal: "Veuillez vous rendre dans la salle d’attente DOW3."
  },
  en: {
    titel: "Your waiting time",
    onderzoeken: {
      botscan: "Bone scan",
      schildklier: "Thyroid scan",
      mibi: "MIBI scan",
      dmsa: "DMSA scan",
      maag: "Gastric emptying study",
      dat: "DAT scan"
    },
    instructies: {
      botscan: "We kindly ask you to drink water regularly.",
      schildklier: "You may take a seat in the waiting area.",
      mibi: "Please have a fatty breakfast, such as bread with cheese or salami.",
      dmsa: "You do not need to fast for this examination.",
      maag: "You may take a seat in the waiting area. An acquisition of approximately one minute will be performed every 30 minutes, for a total of five acquisitions.",
      dat: "You do not need to fast for this examination."
    },
    naarWachtzaal: "Please proceed to waiting area DOW3."
  },
  uk: {
    titel: "Час очікування",
    onderzoeken: {
      botscan: "Сцинтиграфія кісток",
      schildklier: "Сцинтиграфія щитоподібної залози",
      mibi: "MIBI-сканування",
      dmsa: "DMSA-сканування",
      maag: "Дослідження спорожнення шлунка",
      dat: "DAT-сканування"
    },
    instructies: {
      botscan: "Будь ласка, регулярно пийте воду.",
      schildklier: "Ви можете сісти в залі очікування.",
      mibi: "Будь ласка, з’їжте жирний сніданок, наприклад хліб з сиром або салямі.",
      dmsa: "Для цього обстеження не потрібно бути натщесерце.",
      maag: "Ви можете сісти в залі очікування. Кожні 30 хвилин проводиться запис тривалістю приблизно одну хвилину, загалом п’ять записів.",
      dat: "Для цього обстеження не потрібно бути натщесерце."
    },
    naarWachtzaal: "Будь ласка, пройдіть до зали очікування DOW3."
  }
};

/* ===== ELEMENTEN ===== */
const timerEl = document.getElementById("timer");
const exactTijdEl = document.getElementById("exactTijd");
const instructieEl = document.getElementById("instructie");
const imgEl = document.getElementById("instructieAfbeelding");
const boodschapEl = document.getElementById("boodschap");

/* ===== TITEL + ONDERZOEK ===== */
document.getElementById("titel").textContent =
  vertalingen[lang]?.titel || vertalingen.nl.titel;

document.getElementById("onderzoekNaam").textContent =
  vertalingen[lang]?.onderzoeken[onderzoek] ||
  vertalingen.nl.onderzoeken.botscan;

instructieEl.textContent =
  vertalingen[lang]?.instructies[onderzoek] ||
  vertalingen.nl.instructies.botscan;

/* ===== INSTRUCTIEAFBEELDING (botscan/mibi) ===== */
if (onderzoek === "botscan") {
  imgEl.src = "water.png";
  imgEl.style.display = "block";
} else if (onderzoek === "mibi") {
  imgEl.src = "boterham.png";
  imgEl.style.display = "block";
} else {
  imgEl.style.display = "none";
}

/* ===== EXACT TERUGKOMTIJD ===== */
const eindDatum = new Date(endTs);
exactTijdEl.textContent =
  "Terugkomtijd: " +
  eindDatum.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" });

/* ===== TIMER ===== */
let meldingGetoond = false;
let trillingGedaan = false;

// Onderzoeken waarvoor geen 5-min boodschap
const geen5MinBoodschap = ["schildklier", "maag"];

function formatTijd(ms) {
  const s = Math.max(0, Math.floor(ms / 1000));
  const h = Math.floor(s / 3600);
  const m = Math.floor((s % 3600) / 60);
  const sec = s % 60;
  return (h > 0 ? `${h}u ` : "") + `${m} min ${sec.toString().padStart(2,"0")} s`;
}

function updateTimer() {
  const resterend = endTs - Date.now();
  timerEl.textContent = formatTijd(resterend);

  if (resterend <= 5 * 60 * 1000) {
    timerEl.classList.add("timer-rood");

    // instructie + afbeelding weg voor botscan en MIBI
    if (onderzoek === "botscan" || onderzoek === "mibi") {
      instructieEl.textContent = "";
      imgEl.style.display = "none";
    }

    // toon 5-minutenboodschap alleen voor onderzoeken die niet in uitsluitlijst staan
    if (!meldingGetoond && !geen5MinBoodschap.includes(onderzoek)) {
      boodschapEl.textContent = vertalingen[lang].naarWachtzaal;
      boodschapEl.classList.add("fade-in");
      meldingGetoond = true;
    }

    if (!trillingGedaan && navigator.vibrate) {
      navigator.vibrate([300, 200, 300]);
      trillingGedaan = true;
    }
  }

  if (resterend <= 0) {
    timerEl.textContent = "0 min 00 s";
  }
}

updateTimer();
setInterval(updateTimer, 1000);
</script>

</body>
</html>
