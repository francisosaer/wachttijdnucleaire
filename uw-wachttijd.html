<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Uw wachttijd</title>
<style>
body { font-family: Arial, sans-serif; text-align: center; padding: 40px; }
h1 { font-size: 28px; margin-bottom: 20px; }
#timer { font-size: 48px; margin-top: 20px; color: black; }
#message { font-size: 20px; margin-top: 30px; color: #333; white-space: pre-line; }
</style>
</head>
<body>

<h1>Uw wachttijd</h1>
<div id="timer">Ladenâ€¦</div>
<div id="message">Gelieve enkele glazen water te drinken voor een optimaal resultaat.</div>

<script>
const endParam = new URLSearchParams(window.location.search).get("end");
const endTime = Number(endParam);

if (!endTime) {
  document.getElementById("timer").innerText = "Geen wachttijd ingesteld";
} else {
  const timerEl = document.getElementById("timer");
  const messageEl = document.getElementById("message");
  let alertShown = false;

  // Tijdelijke boodschap verdwijnt na 2 minuten
  setTimeout(() => {
    messageEl.innerText = "";
  }, 2 * 60 * 1000); // 2 minuten in milliseconden

  const interval = setInterval(() => {
    const now = Date.now();
    const diff = endTime - now;

    if (diff <= 0) {
      timerEl.innerText = "U bent aan de beurt";
      timerEl.style.color = "#d9534f";
      messageEl.innerText = "";
      clearInterval(interval);
      if (navigator.vibrate) navigator.vibrate([200, 100, 200]);
    } else {
      const hours = Math.floor(diff / 3600000);
      const minutes = Math.floor((diff % 3600000) / 60000);
      const seconds = Math.floor((diff % 60000) / 1000);
      timerEl.innerText = 
        (hours > 0 ? hours + "u " : "") + 
        minutes + "m " + seconds + "s";

      // 5 minuten waarschuwing
      if (diff <= 5*60*1000 && !alertShown) {
        alertShown = true;
        timerEl.style.color = "red";
        messageEl.innerText = "U mag zich begeven naar wachtzaal D0W3.\nGelieve uw blaas kort voor het onderzoek te legen voor een optimaal resultaat.";

        if (navigator.vibrate) {
          navigator.vibrate([500, 200, 500]);
        }

        alert("U mag zich begeven naar wachtzaal D0W3.\nGelieve uw blaas kort voor het onderzoek te legen voor een optimaal resultaat.");
      }
    }
  }, 1000);
}
</script>

</body>
</html>
