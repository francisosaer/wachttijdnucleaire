<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Uw wachttijd</title>

<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    padding: 30px;
    background: #f7f9fb;
  }

  #logo {
    max-width: 180px;
    margin: 0 auto 20px auto;
    display: block;
  }

  h1 {
    margin-bottom: 5px;
  }

  #onderzoekTitel {
    font-size: 1.2em;
    font-weight: 600;
    color: #555;
    margin-bottom: 15px;
  }

  #exactTijd {
    font-size: 1.3em;
    color: #444;
    margin-bottom: 15px;
  }

  #timer {
    font-size: 3em;
    font-weight: bold;
    margin: 15px 0;
  }

  .timer-rood {
    color: #c62828;
  }

  #instructie {
    font-size: 1.15em;
    margin-top: 20px;
    color: #333;
  }

  #instructieAfbeelding {
    margin: 15px auto;
    display: block;
    max-width: 80px;
  }

  .boodschap-groen {
    color: #2e7d32;
    font-weight: 600;
    font-size: 1.25em;
    margin-top: 25px;
    opacity: 0;
    transition: opacity 0.8s ease-in;
  }

  .fade-in {
    opacity: 1;
  }
</style>
</head>

<body>

<img src="sjabloonalma.png" alt="Ziekenhuis AZ Alma" id="logo">

<h1 id="titel"></h1>
<div id="onderzoekTitel"></div>

<div id="exactTijd"></div>
<div id="timer">--</div>

<img id="instructieAfbeelding" style="display:none;">
<div id="instructie"></div>

<div id="boodschap" class="boodschap-groen"></div>

<script>
/* ===== URL PARAMETERS ===== */
const params = new URLSearchParams(window.location.search);
const endTs = Number(params.get("end"));
const onderzoek = params.get("onderzoek") || "botscan";
const lang = params.get("lang") || "nl";

/* ===== VERTALINGEN ===== */
const vertalingen = {
  nl: {
    titel: "Uw wachttijd",
    onderzoeken: {
      botscan: "Botscan",
      schildklier: "Schildklieronderzoek",
      mibi: "MIBI-scan",
      dmsa: "DMSA-scan",
      maag: "Maagontlediging",
      dat: "DAT-scan"
    },
    instructies: {
      botscan: "Gelieve enkele glazen water te drinken.",
      schildklier: "",
      mibi: "Gelieve een vettig ontbijt te nemen (boterham met kaas of salami).",
      dmsa: "U hoeft niet nuchter te zijn.",
      maag: "U mag plaatsnemen in de wachtzaal. Om het halfuur (5 in totaal) zal er een opname gebeuren van ongeveer 1 minuut.",
      dat: "U hoeft niet nuchter te zijn."
    },
    afbeelding: {
      botscan: "water.png",
      mibi: "boterham.png"
    },
    naarWachtzaal: "U mag zich begeven naar wachtzaal DOW3."
  },

  fr: {
    titel: "Votre temps d’attente",
    onderzoeken: {
      botscan: "Scintigraphie osseuse",
      schildklier: "Examen thyroïdien",
      mibi: "Scintigraphie MIBI",
      dmsa: "Scintigraphie DMSA",
      maag: "Vidange gastrique",
      dat: "DAT-scan"
    },
    instructies: {
      botscan: "Veuillez boire plusieurs verres d’eau.",
      schildklier: "",
      mibi: "Veuillez prendre un petit-déjeuner gras (pain avec fromage ou salami).",
      dmsa: "Vous ne devez pas être à jeun.",
      maag: "Veuillez prendre place dans la salle d’attente. Une acquisition aura lieu toutes les 30 minutes (5 au total), durant environ 1 minute.",
      dat: "Vous ne devez pas être à jeun."
    },
    afbeelding: {
      botscan: "water.png",
      mibi: "boterham.png"
    },
    naarWachtzaal: "Veuillez vous rendre dans la salle d’attente DOW3."
  },

  en: {
    titel: "Your waiting time",
    onderzoeken: {
      botscan: "Bone scan",
      schildklier: "Thyroid examination",
      mibi: "MIBI scan",
      dmsa: "DMSA scan",
      maag: "Gastric emptying study",
      dat: "DAT scan"
    },
    instructies: {
      botscan: "Please drink several glasses of water.",
      schildklier: "",
      mibi: "Please have a fatty breakfast (bread with cheese or salami).",
      dmsa: "You do not need to be fasting.",
      maag: "Please take a seat in the waiting area. Imaging will occur every 30 minutes (5 times total), lasting about 1 minute each.",
      dat: "You do not need to be fasting."
    },
    afbeelding: {
      botscan: "water.png",
      mibi: "boterham.png"
    },
    naarWachtzaal: "Please proceed to the waiting area DOW3."
  }
};

/* ===== ELEMENTEN ===== */
const timerEl = document.getElementById("timer");
const exactTijdEl = document.getElementById("exactTijd");
const instructieEl = document.getElementById("instructie");
const boodschapEl = document.getElementById("boodschap");
const afbeeldingEl = document.getElementById("instructieAfbeelding");

/* ===== TITEL & ONDERZOEK ===== */
document.getElementById("titel").textContent =
  vertalingen[lang]?.titel || vertalingen.nl.titel;

document.getElementById("onderzoekTitel").textContent =
  vertalingen[lang]?.onderzoeken[onderzoek] || "";

/* ===== INSTRUCTIE + AFBEELDING ===== */
const instructieTekst = vertalingen[lang]?.instructies[onderzoek] || "";
instructieEl.textContent = instructieTekst;

const afbeelding = vertalingen[lang]?.afbeelding?.[onderzoek];
if (afbeelding) {
  afbeeldingEl.src = afbeelding;
  afbeeldingEl.style.display = "block";
}

/* ===== EXACT TERUGKOMTIJD ===== */
const eindDatum = new Date(endTs);
exactTijdEl.textContent = "Terugkomtijd: " +
  eindDatum.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" });

/* ===== TIMER ===== */
let meldingGetoond = false;
let trillingGedaan = false;

function formatTijd(ms) {
  const s = Math.max(0, Math.floor(ms / 1000));
  const h = Math.floor(s / 3600);
  const m = Math.floor((s % 3600) / 60);
  const sec = s % 60;
  return (h > 0 ? `${h}u ` : "") + `${m} min ${sec.toString().padStart(2,"0")} s`;
}

function updateTimer() {
  const resterend = endTs - Date.now();
  timerEl.textContent = formatTijd(resterend);

  if (resterend <= 5 * 60 * 1000) {
    timerEl.classList.add("timer-rood");

    if (!meldingGetoond) {
      instructieEl.textContent = "";
      afbeeldingEl.style.display = "none";
      boodschapEl.textContent = vertalingen[lang].naarWachtzaal;
      boodschapEl.classList.add("fade-in");
      meldingGetoond = true;
    }

    if (!trillingGedaan && navigator.vibrate) {
      navigator.vibrate([300,200,300]);
      trillingGedaan = true;
    }
  }

  if (resterend <= 0) {
    timerEl.textContent = "0 min 00 s";
  }
}

updateTimer();
setInterval(updateTimer, 1000);
</script>

</body>
</html>
