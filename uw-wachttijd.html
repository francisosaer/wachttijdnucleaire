<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Uw wachttijd</title>

<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    padding: 40px;
  }

  h1 {
    font-size: 26px;
  }

  #timer {
    font-size: 36px;
    margin-top: 20px;
  }

  #instructie {
    margin-top: 25px;
    font-size: 18px;
    line-height: 1.4;
  }

  #hint {
    font-size: 14px;
    color: gray;
    margin-top: 30px;
  }
</style>
</head>

<body>

<h1 id="titel"></h1>
<div id="timer">…</div>
<div id="instructie"></div>
<div id="hint"></div>

<script>
// ============================
// URL PARAMETERS
// ============================
const params = new URLSearchParams(window.location.search);
const end = Number(params.get("end"));
const onderzoek = params.get("onderzoek"); // botscan | schildklier | mibi
const lang = params.get("lang") || "nl";

// ============================
// VERTALINGEN
// ============================
const T = {
  nl: {
    titel: {
      botscan: "Uw wachttijd – Botscan",
      schildklier: "Uw wachttijd – Schildklierscan",
      mibi: "Uw wachttijd – MIBI-scan"
    },
    hint: "Tik één keer op het scherm om trilling te activeren (iOS).",
    geenTijd: "Geen wachttijd ingesteld",
    aanDeBeurt: "U bent aan de beurt",

    start: {
      botscan: "Gelieve in de wachttijd voldoende water te drinken voor een optimaal resultaat.",
      mibi: "Gelieve een vettig ontbijt te nemen (bv. boterham met kaas of salami)."
    },

    vijfMin: {
      botscan:
        "U mag zich begeven naar wachtzaal D0W3.\n" +
        "Gelieve net voor het onderzoek uw blaas te ledigen.",
      schildklier:
        "U mag zich begeven naar wachtzaal D0W3.",
      mibi:
        "U mag zich begeven naar wachtzaal D0W3."
    }
  },

  fr: {
    titel: {
      botscan: "Votre temps d’attente – Scintigraphie osseuse",
      schildklier: "Votre temps d’attente – Scintigraphie thyroïdienne",
      mibi: "Votre temps d’attente – Scintigraphie MIBI"
    },
    hint: "Touchez l’écran une fois pour activer la vibration (iOS).",
    geenTijd: "Aucun temps d’attente défini",
    aanDeBeurt: "C’est votre tour",

    start: {
      botscan:
        "Veuillez boire suffisamment d’eau pendant l’attente pour un résultat optimal.",
      mibi:
        "Veuillez prendre un petit-déjeuner gras (ex. pain avec fromage ou salami)."
    },

    vijfMin: {
      botscan:
        "Veuillez vous rendre en salle d’attente D0W3.\n" +
        "Veuillez vider votre vessie juste avant l’examen.",
      schildklier:
        "Veuillez vous rendre en salle d’attente D0W3.",
      mibi:
        "Veuillez vous rendre en salle d’attente D0W3."
    }
  },

  en: {
    titel: {
      botscan: "Your waiting time – Bone scan",
      schildklier: "Your waiting time – Thyroid scan",
      mibi: "Your waiting time – MIBI scan"
    },
    hint: "Tap the screen once to enable vibration (iOS).",
    geenTijd: "No waiting time set",
    aanDeBeurt: "It is your turn",

    start: {
      botscan:
        "Please drink sufficient water during the waiting time for optimal results.",
      mibi:
        "Please have a fatty breakfast (e.g. bread with cheese or salami)."
    },

    vijfMin: {
      botscan:
        "You may proceed to waiting room D0W3.\n" +
        "Please empty your bladder just before the examination.",
      schildklier:
        "You may proceed to waiting room D0W3.",
      mibi:
        "You may proceed to waiting room D0W3."
    }
  },

  uk: {
    titel: {
      botscan: "Час очікування – Сцинтиграфія кісток",
      schildklier: "Час очікування – Сцинтиграфія щитоподібної залози",
      mibi: "Час очікування – MIBI-сканування"
    },
    hint: "Торкніться екрана один раз, щоб увімкнути вібрацію (iOS).",
    geenTijd: "Час очікування не встановлено",
    aanDeBeurt: "Ваша черга",

    start: {
      botscan:
        "Будь ласка, пийте достатньо води під час очікування для оптимального результату.",
      mibi:
        "Будь ласка, з’їжте жирний сніданок (наприклад, хліб із сиром або салямі)."
    },

    vijfMin: {
      botscan:
        "Будь ласка, пройдіть до зали очікування D0W3.\n" +
        "Перед обстеженням спорожніть сечовий міхур.",
      schildklier:
        "Будь ласка, пройдіть до зали очікування D0W3.",
      mibi:
        "Будь ласка, пройдіть до зали очікування D0W3."
    }
  }
};

// ============================
// INIT
// ============================
const txt = T[lang] || T.nl;
const titel = txt.titel[onderzoek] || "Uw wachttijd";

document.getElementById("titel").innerText = titel;
document.getElementById("hint").innerText = txt.hint;

const instructieDiv = document.getElementById("instructie");

// startboodschap
if (txt.start[onderzoek]) {
  instructieDiv.innerText = txt.start[onderzoek];
}

// ============================
// TRILLING (iOS)
let trillingOK = false;
document.body.addEventListener("click", () => {
  trillingOK = true;
}, { once: true });

// ============================
// TIMER
// ============================
if (!end) {
  document.getElementById("timer").innerText = txt.geenTijd;
} else {

  let vijfMinGedaan = false;

  setInterval(() => {
    const diff = end - Date.now();

    if (diff <= 0) {
      document.getElementById("timer").innerText = txt.aanDeBeurt;
      return;
    }

    const min = Math.floor(diff / 60000);
    const sec = Math.floor((diff % 60000) / 1000);
    document.getElementById("timer").innerText = `${min} min ${sec} sec`;

    if (!vijfMinGedaan && diff <= 5 * 60000) {
      vijfMinGedaan = true;

      document.getElementById("timer").style.color = "red";

      if (navigator.vibrate && trillingOK) {
        navigator.vibrate([500, 200, 500]);
      }

      instructieDiv.innerText = txt.vijfMin[onderzoek];
    }

  }, 1000);
}
</script>

</body>
</html>
