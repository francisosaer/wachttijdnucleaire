<!DOCTYPE html>
<html lang="">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Uw wachttijd</title>

<style>
  body {
    font-family: Arial, sans-serif;
    padding: 30px;
    text-align: center;
    max-width: 420px;
    margin: auto;
  }

  h1 {
    margin-bottom: 20px;
  }

  .timer {
    font-size: 48px;
    font-weight: bold;
    margin: 20px 0;
  }

  .instructie {
    font-size: 18px;
    margin-top: 25px;
  }
</style>
</head>

<body>

<h1 id="titel"></h1>

<div class="timer" id="timer">--:--</div>

<div class="instructie" id="instructie"></div>

<script>
/* -------------------------------
   Parameters uitlezen
-------------------------------- */
const params = new URLSearchParams(window.location.search);
const endTs = Number(params.get("end"));
const onderzoek = params.get("onderzoek");
const lang = params.get("lang") || "nl";

/* -------------------------------
   Teksten per taal & onderzoek
-------------------------------- */
const teksten = {
  nl: {
    titel: "Uw wachttijd",
    botscan: {
      start: "Gelieve enkele glazen water te drinken.",
      vijfmin: "U mag zich begeven naar wachtzaal D0W3.\nGelieve net voor het onderzoek uw blaas te ledigen."
    },
    schildklier: {
      start: "Gelieve plaats te nemen in de wachtzaal.",
      vijfmin: "U mag zich begeven naar wachtzaal D0W3."
    },
    mibi: {
      start: "Gelieve een vettig ontbijt te nemen (boterham met kaas of salami).",
      vijfmin: "U mag zich begeven naar wachtzaal D0W3."
    }
  },

  fr: {
    titel: "Votre temps d’attente",
    botscan: {
      start: "Veuillez boire plusieurs verres d’eau.",
      vijfmin: "Vous pouvez vous rendre à la salle d’attente D0W3.\nVeuillez vider votre vessie juste avant l’examen."
    },
    schildklier: {
      start: "Veuillez prendre place dans la salle d’attente.",
      vijfmin: "Vous pouvez vous rendre à la salle d’attente D0W3."
    },
    mibi: {
      start: "Veuillez prendre un petit-déjeuner gras (fromage ou salami).",
      vijfmin: "Vous pouvez vous rendre à la salle d’attente D0W3."
    }
  },

  en: {
    titel: "Your waiting time",
    botscan: {
      start: "Please drink several glasses of water.",
      vijfmin: "You may proceed to waiting room D0W3.\nPlease empty your bladder just before the examination."
    },
    schildklier: {
      start: "Please take a seat in the waiting area.",
      vijfmin: "You may proceed to waiting room D0W3."
    },
    mibi: {
      start: "Please eat a fatty breakfast (cheese or salami sandwich).",
      vijfmin: "You may proceed to waiting room D0W3."
    }
  },

  uk: {
    titel: "Ваш час очікування",
    botscan: {
      start: "Будь ласка, випийте кілька склянок води.",
      vijfmin: "Ви можете пройти до зали очікування D0W3.\nБудь ласка, спорожніть сечовий міхур перед обстеженням."
    },
    schildklier: {
      start: "Будь ласка, сядьте в залі очікування.",
      vijfmin: "Ви можете пройти до зали очікування D0W3."
    },
    mibi: {
      start: "Будь ласка, з’їжте жирний сніданок (бутерброд з сиром або салямі).",
      vijfmin: "Ви можете пройти до зали очікування D0W3."
    }
  }
};

/* -------------------------------
   Titel instellen
-------------------------------- */
document.getElementById("titel").textContent =
  teksten[lang]?.titel || teksten.nl.titel;

/* -------------------------------
   Instructies tonen
-------------------------------- */
const instructieEl = document.getElementById("instructie");
const instructies = teksten[lang]?.[onderzoek] || teksten.nl[onderzoek];

// startboodschap
if (instructies?.start) {
  instructieEl.textContent = instructies.start;
}

/* -------------------------------
   Timer + 5-minuten-moment
-------------------------------- */
let vijfMinGetoond = false;

function updateTimer() {
  const nu = Date.now();
  const resterend = endTs - nu;

  if (resterend <= 0) {
    document.getElementById("timer").textContent = "00:00";
    return;
  }

  const min = Math.floor(resterend / 60000);
  const sec = Math.floor((resterend % 60000) / 1000);
  document.getElementById("timer").textContent =
    `${String(min).padStart(2,"0")}:${String(sec).padStart(2,"0")}`;

  // 5 minuten-melding
  if (resterend <= 5 * 60000 && !vijfMinGetoond) {
    if (instructies?.vijfmin) {
      instructieEl.textContent = instructies.vijfmin;
    }
    vijfMinGetoond = true;

    // trilsignaal (alleen met user interaction mogelijk op iOS)
    if (navigator.vibrate) {
      navigator.vibrate([300, 200, 300]);
    }
  }
}

updateTimer();
setInterval(updateTimer, 1000);
</script>

</body>
</html>
